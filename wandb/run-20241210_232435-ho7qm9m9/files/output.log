Starting training...
MEMORY BEFORE LOOP:  |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 173428 KiB | 689676 KiB |    840 MiB | 687728 KiB |
|       from large pool | 166400 KiB | 676608 KiB |    822 MiB | 675456 KiB |
|       from small pool |   7028 KiB |  13068 KiB |     18 MiB |  12272 KiB |
|---------------------------------------------------------------------------|
| Active memory         | 173428 KiB | 689676 KiB |    840 MiB | 687728 KiB |
|       from large pool | 166400 KiB | 676608 KiB |    822 MiB | 675456 KiB |
|       from small pool |   7028 KiB |  13068 KiB |     18 MiB |  12272 KiB |
|---------------------------------------------------------------------------|
| Requested memory      | 172342 KiB | 685566 KiB |    835 MiB | 683629 KiB |
|       from large pool | 165376 KiB | 672568 KiB |    817 MiB | 671416 KiB |
|       from small pool |   6966 KiB |  12998 KiB |     18 MiB |  12213 KiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 727040 KiB | 727040 KiB | 727040 KiB |      0 B   |
|       from large pool | 712704 KiB | 712704 KiB | 712704 KiB |      0 B   |
|       from small pool |  14336 KiB |  14336 KiB |  14336 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  29324 KiB |  74728 KiB | 466379 KiB | 437055 KiB |
|       from large pool |  28160 KiB |  68096 KiB | 439552 KiB | 411392 KiB |
|       from small pool |   1164 KiB |   6767 KiB |  26827 KiB |  25663 KiB |
|---------------------------------------------------------------------------|
| Allocations           |     517    |     754    |    1221    |     704    |
|       from large pool |      36    |      73    |     108    |      72    |
|       from small pool |     481    |     681    |    1113    |     632    |
|---------------------------------------------------------------------------|
| Active allocs         |     517    |     754    |    1221    |     704    |
|       from large pool |      36    |      73    |     108    |      72    |
|       from small pool |     481    |     681    |    1113    |     632    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |      24    |      24    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |       7    |       7    |       7    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       9    |      21    |      52    |      43    |
|       from large pool |       7    |      14    |      33    |      26    |
|       from small pool |       2    |       7    |      19    |      17    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Training:   0%|          | 0/2997 [00:00<?, ?it/s]

MEMORY BEFORE FEATURE EXTRACTION:  |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 188128 KiB | 689676 KiB |    855 MiB | 687728 KiB |
|       from large pool | 181100 KiB | 676608 KiB |    836 MiB | 675456 KiB |
|       from small pool |   7028 KiB |  13068 KiB |     18 MiB |  12272 KiB |
|---------------------------------------------------------------------------|
| Active memory         | 188128 KiB | 689676 KiB |    855 MiB | 687728 KiB |
|       from large pool | 181100 KiB | 676608 KiB |    836 MiB | 675456 KiB |
|       from small pool |   7028 KiB |  13068 KiB |     18 MiB |  12272 KiB |
|---------------------------------------------------------------------------|
| Requested memory      | 187042 KiB | 685566 KiB |    850 MiB | 683629 KiB |
|       from large pool | 180076 KiB | 672568 KiB |    831 MiB | 671416 KiB |
|       from small pool |   6966 KiB |  12998 KiB |     18 MiB |  12213 KiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 727040 KiB | 727040 KiB | 727040 KiB |      0 B   |
|       from large pool | 712704 KiB | 712704 KiB | 712704 KiB |      0 B   |
|       from small pool |  14336 KiB |  14336 KiB |  14336 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  35104 KiB |  74728 KiB | 472159 KiB | 437055 KiB |
|       from large pool |  33940 KiB |  68096 KiB | 445332 KiB | 411392 KiB |
|       from small pool |   1164 KiB |   6767 KiB |  26827 KiB |  25663 KiB |
|---------------------------------------------------------------------------|
| Allocations           |     518    |     754    |    1223    |     705    |
|       from large pool |      37    |      73    |     109    |      72    |
|       from small pool |     481    |     681    |    1114    |     633    |
|---------------------------------------------------------------------------|
| Active allocs         |     518    |     754    |    1223    |     705    |
|       from large pool |      37    |      73    |     109    |      72    |
|       from small pool |     481    |     681    |    1114    |     633    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |      24    |      24    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |       7    |       7    |       7    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      10    |      21    |      53    |      43    |
|       from large pool |       8    |      14    |      34    |      26    |
|       from small pool |       2    |       7    |      19    |      17    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

MEMORY AFTER FEATURE EXTRACTION:  |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 296198 KiB |   4919 MiB |   6386 MiB |   6097 MiB |
|       from large pool | 285644 KiB |   4908 MiB |   6335 MiB |   6056 MiB |
|       from small pool |  10554 KiB |     12 MiB |     50 MiB |     40 MiB |
|---------------------------------------------------------------------------|
| Active memory         | 296198 KiB |   4919 MiB |   6386 MiB |   6097 MiB |
|       from large pool | 285644 KiB |   4908 MiB |   6335 MiB |   6056 MiB |
|       from small pool |  10554 KiB |     12 MiB |     50 MiB |     40 MiB |
|---------------------------------------------------------------------------|
| Requested memory      | 280422 KiB |   4840 MiB |   6267 MiB |   5993 MiB |
|       from large pool | 269932 KiB |   4828 MiB |   6216 MiB |   5953 MiB |
|       from small pool |  10490 KiB |     12 MiB |     50 MiB |     40 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4976 MiB |   4976 MiB |   4976 MiB |      0 B   |
|       from large pool |   4962 MiB |   4962 MiB |   4962 MiB |      0 B   |
|       from small pool |     14 MiB |     14 MiB |     14 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1514 MiB |   1514 MiB |   3458 MiB |   1943 MiB |
|       from large pool |   1513 MiB |   1513 MiB |   3400 MiB |   1887 MiB |
|       from small pool |      1 MiB |      6 MiB |     57 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     599    |     932    |    1740    |    1141    |
|       from large pool |      72    |     246    |     382    |     310    |
|       from small pool |     527    |     686    |    1358    |     831    |
|---------------------------------------------------------------------------|
| Active allocs         |     599    |     932    |    1740    |    1141    |
|       from large pool |      72    |     246    |     382    |     310    |
|       from small pool |     527    |     686    |    1358    |     831    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     135    |     135    |     135    |       0    |
|       from large pool |     128    |     128    |     128    |       0    |
|       from small pool |       7    |       7    |       7    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      78    |      83    |     345    |     267    |
|       from large pool |      47    |      56    |     248    |     201    |
|       from small pool |      31    |      32    |      97    |      66    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  File "/work/scratch/kurse/kurs00079/ng33rete/Project-Lab-MAI/train_intra_loss.py", line 276, in <module>
    main()
  File "/work/scratch/kurse/kurs00079/ng33rete/Project-Lab-MAI/train_intra_loss.py", line 213, in main
    train_metrics = train_epoch(model, train_loader, optimizer, device)
  File "/work/scratch/kurse/kurs00079/ng33rete/Project-Lab-MAI/train_intra_loss.py", line 105, in train_epoch
    loss = intra_modal_consistency_loss(frame_features)
  File "/work/scratch/kurse/kurs00079/ng33rete/Project-Lab-MAI/loss_function.py", line 19, in intra_modal_consistency_loss
    N, T, d = identity_features.shape
ValueError: not enough values to unpack (expected 3, got 2)
